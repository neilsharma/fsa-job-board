---
import DefaultLayout from '@layouts/DefaultLayout.astro'
import UsaGovBanner from '@components/UsaGovBanner.astro'
import { getCollection } from 'astro:content'
import fsaLogo from '@assets/fsa-logo.svg'
import fsaLogoMobile from '@assets/fsa-logo-mobile.svg'

const jobs = (await getCollection('jobs')).sort((a, b) => {
  const dateA = new Date(a.data.postedDate)
  const dateB = new Date(b.data.postedDate)
  return dateB.getTime() - dateA.getTime() // Sort descending (newest first)
})

// Debug: log the first job to see what data we have
console.log('First job data:', jobs[0]?.data)
---

<DefaultLayout title="FSA Careers" noHeader={true}>
  <!-- USA Government Official Banner -->
  <UsaGovBanner />

  <!-- Header with Logo -->
  <header class="border-b border-gray-200" style="background-color: #eee; padding-top: 16px; padding-bottom: 16px;">
    <div class="mx-auto max-w-[1200px] px-4 sm:px-6">
      <picture>
        <source media="(min-width: 640px)" srcset={fsaLogo.src} />
        <img src={fsaLogoMobile.src} alt="Federal Student Aid" class="h-12 sm:h-14" />
      </picture>
    </div>
  </header>

  <!-- Hero Image Section with Overlay Text -->
  <div class="relative w-full overflow-hidden" style="padding-top: 140px; padding-bottom: 140px;">
    <img
      src={`${import.meta.env.BASE_URL}/college-students-hero.jpg`}
      alt="College students in lecture hall"
      class="absolute inset-0 h-full w-full object-cover"
      style="filter: saturate(0.6);"
      loading="eager"
      fetchpriority="high"
    />
    <div class="absolute inset-0 bg-black opacity-35"></div>

    <!-- Content -->
    <div class="relative mx-auto max-w-[1200px] px-4 sm:px-6">
      <h1
        class="mb-4 text-4xl text-white sm:mb-6 sm:text-5xl md:text-6xl lg:text-7xl"
        style="line-height: 1.1; font-weight: 700; letter-spacing: -0.02em; text-shadow: 0 1px 4px rgba(0, 0, 0, 0.8), 0 2px 8px rgba(0, 0, 0, 0.6); text-transform: uppercase;"
      >
        Unlocking Higher Education for America
      </h1>
      <p
        class="mb-6 text-lg text-white sm:mb-8 sm:text-xl md:text-2xl"
        style="line-height: 1.4; font-weight: 500; text-shadow: 0 1px 4px rgba(0, 0, 0, 0.7), 0 2px 6px rgba(0, 0, 0, 0.5);"
      >
        We're making Federal Student Aid easier for millions of families.
      </p>
      <a
        href={`${import.meta.env.BASE_URL}/#open-positions`}
        class="cta-button inline-block px-8 py-4 text-lg font-medium transition-all sm:px-10 sm:py-5 sm:text-xl"
        style="background-color: white; color: black; border-radius: 5px; text-decoration: none;"
      >
        View Open Roles →
      </a>
    </div>
  </div>

  <!-- Impact Section (white background) -->
  <section class="border-b border-gray-200" style="background-color: #eee; padding-top: 60px; padding-bottom: 60px;">
    <div class="mx-auto max-w-[1200px] px-4 sm:px-6">
      <div class="mb-10 text-center md:mb-16">
        <h2 class="font-display mb-4 text-3xl font-semibold tracking-tight sm:text-4xl md:mb-6 md:text-5xl lg:text-6xl">
          Our future depends on it
        </h2>
        <p class="mx-auto max-w-3xl text-lg leading-relaxed text-gray-600 sm:text-xl">
          Federal Student Aid serves nearly every family pursuing higher education. These programs determine access,
          affordability, and expanding opportunity for millions.
        </p>
      </div>
      <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 md:gap-12 lg:grid-cols-4 lg:gap-8">
        <div class="relative text-center md:px-6">
          <div class="relative inline-block py-8">
            <div class="absolute inset-0 flex items-center justify-center opacity-[0.05]">
              <svg width="200" height="200" viewBox="0 0 200 200">
                <circle cx="100" cy="100" r="80" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="60" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="40" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
              </svg>
            </div>
            <div class="relative">
              <div
                class="mb-4 text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                DISTRIBUTES
              </div>
              <div class="mb-4 text-5xl font-bold tracking-tighter text-gray-900 md:text-7xl" style="line-height: 1;">
                $120B+
              </div>
              <div
                class="text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                IN STUDENT AID ANNUALLY
              </div>
            </div>
          </div>
        </div>
        <div class="relative text-center md:px-6">
          <div class="relative inline-block py-8">
            <div class="absolute inset-0 flex items-center justify-center opacity-[0.05]">
              <svg width="200" height="200" viewBox="0 0 200 200">
                <circle cx="100" cy="100" r="80" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="60" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="40" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
              </svg>
            </div>
            <div class="relative">
              <div
                class="mb-4 text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                SERVES
              </div>
              <div class="mb-4 text-5xl font-bold tracking-tighter text-gray-900 md:text-7xl" style="line-height: 1;">
                18M+
              </div>
              <div
                class="text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                STUDENTS EVERY YEAR
              </div>
            </div>
          </div>
        </div>
        <div class="relative text-center md:px-6">
          <div class="relative inline-block py-8">
            <div class="absolute inset-0 flex items-center justify-center opacity-[0.05]">
              <svg width="200" height="200" viewBox="0 0 200 200">
                <circle cx="100" cy="100" r="80" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="60" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="40" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
              </svg>
            </div>
            <div class="relative">
              <div
                class="mb-4 text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                SUPPORTS
              </div>
              <div class="mb-4 text-5xl font-bold tracking-tighter text-gray-900 md:text-7xl" style="line-height: 1;">
                5,000+
              </div>
              <div
                class="text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                INSTITUTIONS RECEIVING AID
              </div>
            </div>
          </div>
        </div>
        <div class="relative text-center md:px-6">
          <div class="relative inline-block py-8">
            <div class="absolute inset-0 flex items-center justify-center opacity-[0.05]">
              <svg width="200" height="200" viewBox="0 0 200 200">
                <circle cx="100" cy="100" r="80" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="60" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
                <circle cx="100" cy="100" r="40" fill="none" stroke="#9CA3AF" stroke-width="1.5"></circle>
              </svg>
            </div>
            <div class="relative">
              <div
                class="mb-4 text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                MANAGES
              </div>
              <div class="mb-4 text-5xl font-bold tracking-tighter text-gray-900 md:text-7xl" style="line-height: 1;">
                $1.6T
              </div>
              <div
                class="text-sm tracking-widest text-black uppercase"
                style="letter-spacing: 0.15em; font-weight: 700;"
              >
                IN FEDERAL STUDENT LOANS
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Mission Statement (FSA teal radial gradient) -->
  <section
    class="relative overflow-hidden"
    style="background: radial-gradient(ellipse at center, #285D6C 0%, #1f4a52 40%, #13303A 80%); padding-top: 100px; padding-bottom: 100px; border-bottom: 1px solid transparent; border-image: linear-gradient(to right, transparent, rgba(255,255,255,0.2) 50%, transparent) 1;"
  >
    <!-- Subtle grain texture -->
    <div
      class="absolute inset-0 opacity-[0.015]"
      style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 200 200%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter id=%22noiseFilter%22%3E%3CfeTurbulance type=%22fractalNoise%22 baseFrequency=%220.9%22 numOctaves=%224%22 /%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noiseFilter)%22/%3E%3C/svg%3E');"
    >
    </div>

    <!-- Grid pattern with radial fade -->
    <div
      class="absolute inset-0"
      style="background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px); background-size: 40px 40px; mask-image: radial-gradient(ellipse at center, black 30%, transparent 100%); -webkit-mask-image: radial-gradient(ellipse at center, black 30%, transparent 100%); opacity: 0.55;"
    >
    </div>

    <!-- Fading separator line at bottom -->
    <div
      class="absolute right-0 bottom-0 left-0 h-px"
      style="background: linear-gradient(to right, transparent 0%, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%, transparent 100%);"
    >
    </div>

    <div class="relative mx-auto max-w-[800px] px-6">
      <h2 class="font-display mb-8 text-center text-3xl font-medium tracking-tight text-white sm:text-4xl md:text-5xl">The Work</h2>

      <p class="mb-8 text-white" style="font-size: 21px; line-height: 1.65;">
        Millions of students depend on federal student aid. When the system slows down or breaks, futures are delayed.
        We're here to fix that.
      </p>

      <p class="text-white opacity-90" style="font-size: 21px; line-height: 1.65;">
        We're a small, high-performing team modernizing the technology behind Federal Student Aid — improving the speed
        and reliability of core services, modernizing financial flows and eligibility logic, and building simpler, more
        resilient systems at national scale. This work is so important it has deep support across the political
        spectrum.
      </p>
    </div>
  </section>

  <!-- Job Listings -->
  <section
    id="open-positions"
    class="relative"
    style="background: linear-gradient(180deg, #13303A 0%, #0a1f28 100%); padding-top: 100px; padding-bottom: 100px;"
  >
    <!-- Dot grid pattern with vertical fade -->
    <div
      class="absolute inset-0 pointer-events-none"
      style="background-image: radial-gradient(circle, rgba(255,255,255,0.10) 1px, transparent 1px); background-size: 24px 24px; mask-image: linear-gradient(to bottom, black 0%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, black 0%, transparent 100%);"
    >
    </div>
    <div class="mx-auto max-w-3xl px-6">
      <div class="mb-16">
        <h2 class="font-display mb-12 text-center text-3xl font-medium tracking-tight text-white sm:text-4xl md:text-5xl">
          Open Positions
        </h2>
        <p class="text-white" style="font-size: 21px; line-height: 1.65;">
          Our team comes from Google, Meta, The White House, and other top organizations. We're building one of the
          highest talent-density teams in government. Driven by high ownership, high urgency, high standards.
        </p>
      </div>

      <div class="space-y-6">
        {
          jobs.map((job) => (
            <a
              href={`${import.meta.env.BASE_URL}/jobs/${job.id}`}
              class="group block border-b border-white/20 pb-6 last:border-b-0"
              style="text-decoration: none !important;"
            >
              <article class="flex items-start justify-between gap-8 transition-opacity hover:opacity-70">
                <div class="flex-1">
                  <h3 class="mb-2 text-2xl leading-tight font-semibold tracking-tight text-white">{job.data.title}</h3>
                  <div class="mb-2 flex items-center gap-2">
                    {job.data.roleType && (
                      <span class="inline-flex items-center rounded border border-white/20 bg-white/10 px-2.5 py-0.5 text-xs font-medium text-white/90">
                        {job.data.roleType}
                      </span>
                    )}
                    <span class="text-base text-white/70">{job.data.location}</span>
                  </div>
                </div>
                <div class="pt-1 text-base whitespace-nowrap text-white/70">View details →</div>
              </article>
            </a>
          ))
        }
      </div>
    </div>
  </section>
</DefaultLayout>

<style>
  .cta-button:hover {
    background-color: #f3f4f6 !important;
  }

  .cta-button:active {
    background-color: #e5e7eb !important;
    transform: scale(0.98);
  }
</style>
